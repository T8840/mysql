(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{450:function(t,s,a){"use strict";a.r(s);var n=a(2),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"分析查询执行情况与查询优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分析查询执行情况与查询优化"}},[t._v("#")]),t._v(" 分析查询执行情况与查询优化")]),t._v(" "),s("h3",{attrs:{id:"查询分析语句"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查询分析语句"}},[t._v("#")]),t._v(" 查询分析语句")]),t._v(" "),s("p",[t._v("查询分析语句的语法结构是："),s("br"),t._v("\nEXPLAIN 查询语句;")]),t._v(" "),s("h3",{attrs:{id:"查询优化方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查询优化方案"}},[t._v("#")]),t._v(" 查询优化方案")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("优化查询最有效的方法就是创建索引"),s("br"),t._v("\n在包含关键字“LIKE”和“OR”的条件语句中，利用索引提高查询效率。")])]),t._v(" "),s("li",[s("p",[t._v("子查询的执行效率不高，可替换为连接查询"),s("br"),t._v("\n子查询的执行效率不高。因为MySQL会用临时表把子查询的结果保存起来，然后再使用临时表的内容完成查询。这样一来，查询就多了一个创建临时表的过程，执行效率没有连接查询高。")])]),t._v(" "),s("li",[s("p",[t._v("数据类型优化"),s("br"),t._v("\n2种方法，一种是针对整数类型数据，尽量使用小的整数类型来定义；另外一种是，如果字段既可以用文本类型，也可以用整数类型，尽量使用整数类型。")])]),t._v(" "),s("li",[s("p",[t._v("合理增加冗余字段"),s("br"),t._v("\n在数据量大，而且需要频繁进行连接的时候，为了提升效率，我们也可以考虑增加冗余字段来减少连接。")])]),t._v(" "),s("li",[s("p",[t._v("拆分表"),s("br"),t._v("\n拆分表的思路是，把1个包含很多字段的表拆分成2个或者多个相对较小的表。"),s("br"),t._v("\n这样做的原因是，这些表中某些字段的操作频率很高，经常要进行查询或者更新操作，而另外一些字段的使用频率却很低，如果放在一个表里面，每次查询都要读取大记录，会消耗较多的资源。")])]),t._v(" "),s("li",[s("p",[t._v("使用非空约束"),s("br"),t._v("\n在设计字段的时候，如果业务允许，建议尽量使用非空约束。这样做的好处是，可以省去判断是否为空的开销，提高存储效率。而且，非空字段也容易创建索引。使用非空约束，甚至可以节省存储空间（每个字段1个比特）。")])])]),t._v(" "),s("h3",{attrs:{id:"千万条记录-分页查询进行优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#千万条记录-分页查询进行优化"}},[t._v("#")]),t._v(" 千万条记录，分页查询进行优化")]),t._v(" "),s("p",[t._v("如果sql中有1000w条数据，使用\nSELECT id,val FROM t_test LIMIT 9000000,10;\n需要时间3.s\n针对上面语句进行优化：")]),t._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据连续时优化语句：")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("val "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_test "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9000000")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LIMIT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("val "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_test "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9000000")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9000010")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据不连续时优化语句：")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("val "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_test t "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" id  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" t_test "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LIMIT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9000000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" ） tmp\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" t"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tmp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);